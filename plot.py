# -*- coding: utf-8 -*-
"""Copy of Plot SST koodi inputil vannal engane irikkum.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1YELudx6kstMW9t_yj0GozsBVIo6T6A8J

l 7, epoch 10, batchsize 32, l-lookback period, n-no of predicting days, N-no of times
"""

import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
import scipy.io

N=720 #24 hours x30 lookback period
l=30  #lookback
n=1   #number of days predicting

data=pd.read_csv('/content/drive/MyDrive/mtech/project/lstm_sst_2/moored_buoy_data/bd10/combined_3.csv')
df=data.iloc[:40000,:]
data_matrix=df.to_numpy()
data_sliced=data_matrix[:,3:]



#data_sliced=data_matrix[5000:5500,3:]

#slice of data; this data is from #19-5-2012 3am - 19/5/2018 3 am

import tensorflow as tf
# from tf.keras.models import Sequential
from tensorflow.keras.utils import plot_model
from tensorflow.keras.models import Model
from tensorflow.keras.layers import Input
from tensorflow.keras.layers import Dense
from tensorflow.keras.layers import Dropout
from tensorflow.keras.layers import LSTM
from tensorflow.keras.layers import concatenate
from keras.models import load_model
model=load_model('/content/drive/MyDrive/mtech/project/lstm_sst_2/code/functional_api/timeandsst/model/sst_anomaly_l4_comb_epoch5_batch_64_v9.hdf5')

data_slice_test=data_sliced[30000:31000,:]

sst_testing_complete = data_sliced[31000:31000+N+n+1,:1] #15/1/2019 3pm-31/5/2019 9pm
sst_testing_complete_test=data_sliced[31000:31000+N+n+1,:]
sst_total = np.concatenate((data_slice_test,sst_testing_complete_test), axis=0)

test_inputs = sst_total[len(sst_total) - len(sst_testing_complete) - l:]
from sklearn.preprocessing import MinMaxScaler
scaler = MinMaxScaler(feature_range = (0, 1))
test_inputs1 = scaler.fit_transform(test_inputs)

pred=np.array(pred).reshape(-1,1)

#import datetime
import matplotlib.pyplot as pylt
plt.figure(figsize=(5,3))
plt.plot(sst_testing_complete, color='blue', label='Actual SST')

plt.plot(pred , color='red', label='Predicted SST')
plt.title("SST Anomaly Prediction 2 L=%d"%(l))

#pylt.set_xlim([datetime.date(2018, 5, 1), datetime.date(2018, 5, 30)])
plt.ylabel('SST anomaly')
#pylt.ylim(0,35)
plt.legend()
plt.show()